.. _audio-converter:

音频转换工具
===============================

该工具用于SPV1x指定格式的音频数据文件的内容控制和整体封装。

软件组成
-------------------------------

音频转换工具的文件组成如下：

 1. tools子文件夹，用于存放编解码工具和所依赖的动态链接库。
 2. AudioConvertTool.exe为软件主体，双击即可运行。随着版本更新，名称会有所变化。
 3. default.ucfg为软件的配置文件。

使用说明
-------------------------------

 **1. 主界面描述**

 .. image:: ../_static/spv1x-audio-converter-1.png
  :align: center

 **2. 音频打包界面描述**

   在主界面下，点击菜单栏的“工具”，选择“音频文件打包”，即可打开音频打包界面。音频打包用于将转码后的目标文件，打包成一个SPV1x可以识别的媒体资源文件。

 .. image:: ../_static/spv1x-audio-converter-2.png
  :align: center

 **3. 音频播放测试操作**

   a. 点击“播放测试”区域的“打开”按钮，然后从弹出的文件选择对话框中选择需要播放的文件。
   b. 等待文件处理完成。文件所需的处理时间与文件的类型和大小有关。
   c. 点击“播放测试”区域的“播放”按钮，开始试听音频。
   d. 点击“播放测试”区域的“停止”按钮，可结束试听。

 **4.音频转码操作**

   a. 点击“转换文件列表”区域的“添加文件”按钮，然后从弹出的文件选择对话框中选择需要转码的文件，此处可以进行多个文件的同时选择。如果需要清空列表中的文件，点击“转换文件列表”区域的“清空文件”按钮。
   b. 点击“输出设置”区域的“打开”按钮，然后从弹出的对话框中选择用于保存输出文件的目录。
   c. 在“输出设置”区域的“格式”、“采样率”、“码率”区域，选择目标文件的格式、音频采样率和码率（比特率）参数。不同格式的目标输出文件，其所能支持的采样率和码率也是不一样的。
   d. 点击“状态和操作”区域的“开始转换”按钮，开始转码操作。转码过程中，可以点击“状态和操作”区域的“停止转换”按钮，请求结束转码过程，软件会在当前文件处理完成后，终止转码过程。

 **5. 音频打包操作**

   a. 点击主界面菜单栏的“工具”->“音频文件打包”，打开音频打包界面。
   b. 点击“添加文件”按钮，然后从弹出的文件选择对话框中选择需要打包的文件，此处可以进行多个文件的同时选择。
   c. 如果有文件选择错误，可以使用“移除文件”按钮，将文件列表中选中的文件移除，或使用“移除全部”按钮，将文件列表中所有的文件移除，然后再重新添加。
   d. 使用“上移↑”和“下移↓”按钮，调整文件列表中的文件顺序。此处的文件顺序将代表SPV1x播放时的顺序。
   e. 点击“打包输出”按钮，在弹出的“保存输出文件”对话框中选择保存的路径和文件名，最后点击“保存”按钮，完成文件的打包。

注意事项
-------------------------------

 1. 请保持软件组成中所描述的文件之间的相对层级关系，否则会出现运行错误。
 2. 目前支持的文件格式之间转换关系如下：
   
   - 当目标文件格式是MP3时，输入文件格式支持WAV和MP3，输出文件后缀为“mp3”。
   - 当目标文件格式是S1A时，输入文件格式支持WAV和MP3，输出文件后缀为“s1a”。
   - 当目标文件格式是MID时，输入文件格式支持MID，输出文件后缀为“smd”。
   - 当目标文件格式是SILK时，输入文件格式支持WAV和MP3，输出文件后缀为“slk”。
   - 当目标文件格式是IMA时，输入文件格式支持WAV（单声道），输出文件后缀为“ima”。

 3. 播放测试目前只支持“.wav”、“.mp3”和“.s1a”。
 4. MID文件的转码较为特殊，在进行MID文件的转码时，除了每个“.mid”文件生成对应的“.smd”文件外，还会根据当前所有输入的MID生成一个公用的“.ssf”文件。因此，在音频打包时，如果文件列表包含”.smd”文件，还需要将对应“.ssf”文件一起打包进去。
 5. 软件运行时，会生成临时文件夹。软件退出后，临时文件夹会自动清除。
 6. 不同版本上位机略有差别，请以实际使用的上位机版本为准。